## Two-Level Parallelism in GPUs
[Back to Table of Content](../../Readme.md) | [Previous: hread Hierarchy in GPUs and Data parallel model](5.GPU_Thread_Hierarchy-DataParalellModel.md) | **[Next: Synchronization in GPU Threads](7.synchronization.md)**

CPUs typically have a single level of parallelism with thread IDs. In contrast, GPUs have **two levels of parallelism**:

1. A grid of thread blocks, where each block is assigned to an SM by the *thread block scheduler*. Thread blocks are allocated to different Streaming Multiprocessors (SMs) according to a scheduling policy. For example, SM0 first loads a thread block \( t_0 \) and, if it has remaining resources[^1], may load another thread block \( t_1 \) until it reaches capacity. SM1 and the other SMs follow the same process. This allocation is managed by the thread block scheduler.

2. Inside each thread block, there are **warps**, which are groups of 32 threads executing in parallel. Warps serve as the fundamental units of execution, and the SM's *warp scheduler* schedules an entire warp each time. Within each SM, the internal warp scheduler concurrently schedules warps from different thread blocks. It cycles through these warps until one thread block completes, at which point it signals the outer thread block scheduler to load another thread block into the SM.

[^1]: High register usage in warps can reduce the number of active warps in an SM, limiting its ability to hide memory latency. On the other hand, using very few registers increases memory access, which may lead to excessive memory calls. Balancing register usage and memory calls is key to maximizing GPU performance, ensuring that the SM can effectively hide memory latency and maintain high occupancy.

<div style="display: flex; justify-content: space-around;">
    <div style="text-align: center;">
        <img src="./imgs/2-level-par.png" alt="Efficiency Comparison 1" style="width: 400px; height: 500px;">
        <p>A grid of thread blocks</p>
    </div>
    <div style="text-align: center;">
        <img src="./imgs/tb-sm-assignment.png" alt="Efficiency Comparison 2" style="width: 500px; height: 400px;">
        <p>Thread blocks assignment to SMs</p>
    </div>
</div>
Image Source: Nvidia 

[Back to Table of Content](../../Readme.md) | [Previous: hread Hierarchy in GPUs and Data parallel model](5.GPU_Thread_Hierarchy-DataParalellModel.md) | **[Next: Synchronization in GPU Threads](7.synchronization.md)**
